namespace: fastapi
fastapi:
  defines: runnable
  metadata:
    name: fastapi
    description: A FastAPI application in Python for managing users and questions.
    icon: https://emojiapi.dev/api/v1/snake.svg
  containers:
    fastapi:
      build: .
  services:
    app-main-port:
      container: fastapi
      port: 8002
      host-port: 8002
      publish: false
      protocol: TCP
      description: Main port for the FastAPI application.
  connections:
    database:
      target: fastapi/db
      service: postgres
  variables:
    database-url:
      env: DATABASE_URL
      type: string
      description: URL to connect to the database.
      value: <- connection-hostname("database")
    postgres-user:
      env: POSTGRES_USER
      type: string
      description: Username to connect to the database.
      value: fastapi
    postgres-password:
      env: POSTGRES_PASSWORD
      type: string
      description: Password to connect to the database.
      value: '!!!SETME-USE-SECRETS!!!'
    postgres-db:
      env: POSTGRES_DB
      type: string
      description: Database name to connect to.
      value: fastapi
    app-port:
      env: APP_PORT
      type: string
      description: Main port for the FastAPI application.
      value: '8000'
db:
  defines: runnable
  inherits: postgresql/db
stack:
  defines: group
  runnable-list:
    - fastapi/fastapi
    - fastapi/db
